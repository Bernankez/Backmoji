---
layout: ./_Index.astro
---

## Install

```sh
npm install backmoji
```

## Usage

```ts
import { backmoji, createTextRenderer } from "backmoji";

const canvas = document.createElement("canvas");
const renderer = createTextRenderer("ðŸ‘Œ");
const { render } = backmoji(canvas, renderer);
render();
```

## Examples

### The Basic pattern

import BasicPattern from "@/demos/BasicPattern.astro";

<BasicPattern />

```ts
import { backmoji, createTextRenderer } from "backmoji";

const parent = document.querySelector<HTMLDivElement>("#demo-basic-pattern")!;
const canvas = document.createElement("canvas");

const renderer = createTextRenderer("ðŸ˜¯", {
  font: "40px Aria",
});
const height = 160;
const { render, setSize } = backmoji(canvas, renderer, {
  degree: 30,
  rowGap: 30,
  columnGap: 40,
});

setSize(parent.clientWidth, height);

const observer = new ResizeObserver((entries) => {
  for (const entry of entries) {
    setSize(entry.contentRect.width, height);
    render();
  }
});
observer.observe(parent);

parent.appendChild(canvas);
render();
```

### Render an image with custom render function

import ImagePattern from "@/demos/ImagePattern.astro";

<ImagePattern />

```ts
import { type Renderer, backmoji, createImageRenderer } from "backmoji";
import Avatar from "/avatar.png?url";

const canvas = document.createElement("canvas");
const parent = document.querySelector<HTMLDivElement>("#demo-image-pattern")!;

function loadImage() {
  return new Promise<HTMLImageElement>((resolve) => {
    const image = document.createElement("img");
    image.onload = () => {
      resolve(image);
    };
    image.src = Avatar;
    image.width = 200;
    image.height = 200;
  });
}

function createRenderer() {
  return new Promise<Renderer>(async (resolve) => {
    const img = await loadImage();
    const renderer = createImageRenderer(img, {
      custom({ ctx, item, renderItemWidth, renderItemHeight, rowGap, columnGap, columnCount, rowCount }) {
        for (let rowIndex = 0; rowIndex < rowCount; rowIndex++) {
          let from: number, to: number;
          if (rowIndex % 2 === 0) {
            from = -2;
            to = columnCount;
          } else {
            from = 0;
            to = columnCount + 2;
          }
          for (let columnIndex = from; columnIndex < to; columnIndex++) {
            const x = columnIndex * (renderItemWidth + columnGap);
            const y = rowIndex * (renderItemHeight + rowGap);
            if ((columnIndex - rowIndex) % 2 === 0) {
              ctx.drawImage(item, x, y, renderItemWidth, renderItemHeight);
            }
          }
        }
      },
    });
    resolve(renderer);
  });
}

const height = 300;
const renderer = createRenderer();
const { render, setSize } = backmoji(canvas, renderer, {
  degree: -30,
  rowGap: 50,
  columnGap: 60,
});

const observer = new ResizeObserver((entries) => {
  for (const entry of entries) {
    setSize(entry.contentRect.width, height);
    render();
  }
});
observer.observe(parent);

parent.appendChild(canvas);
render();
```

### Render with animation

### Using with React

import { WithReact } from "@/demos/WithReact";

<WithReact client:visible />

### Using with Vue

import WithVue from "@/demos/WithVue.vue";

<WithVue client:visible />

### Options
